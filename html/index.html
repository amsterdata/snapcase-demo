<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Snapcase Demo</title>
    <link rel="stylesheet" type="text/css" href="styles.css"/>
    <script src="products.js"></script>
    <script src="aisles.js"></script>
    <script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.28.1/cytoscape.min.js"></script>
</head>
<body>
<p>
<h2>Instacart Dataset</h2>
<b>Purchase database</b><br/>
206,210 users<br/>
49,689 items<br/>
33,819,106 purchases<br/>
<br/>
<b>Materialised recommendation model (TIFU)</b><br/>
206,210 sparse embeddings of dimension 49,689<br/>
Top-k index with 10,310,340 entries
<br/>
<br/>

<div>
    <button id="alcohol-button" class="tab-button active-tab-button" onclick="openTab('alcohol')">Alcohol</button>
    <button id="meat-button" class="tab-button" onclick="openTab('meat')">Meat</button>
    <button id="unhealthy-button" class="tab-button" onclick="openTab('unhealthy')">Unhealthy food</button>
</div>

<!-- Tab content -->
<div id="alcohol" class="tab active-tab">
    Sample users with alcohol purchases: <a href="javascript:userFocus(93210);">93210</a>, <a href="javascript:userFocus(66492);">66492</a><br/>
</div>

<div id="meat" class="tab">
    Sample users with meat purchases:<a href="javascript:userFocus(127686);">127686</a>, <a href="javascript:userFocus(195704);">195704</a>
</div>

<div id="unhealthy" class="tab">
    Sample users with unhealthy food purchases: <a href="javascript:userFocus(119964);">119964</a>, <a href="javascript:userFocus(169797);">169797</a>
</div>
</p>


<h3>Relational Database</h3>
<div style="padding: 5px; border: 1px solid black; width: 1200px;">
    <b>Purchases</b>
    <div id="baskets"></div>
</div>
<h3>Recommendation Model (Materialised View)</h3>
<div style="padding: 5px; border: 1px solid black; width: 1200px;">
    <b>Recommendations</b>
    <div id="recommendations"></div>
    <br/>
    <b>Sparse Embedding</b>
    <div id="embedding"></div>
    <br/>
    <b>Neighbors</b>
    <div id="neighbors" style="width:1200px; height: 50px;"></div>
    <div id="cy" style="padding: 5px; width: 1150px; height: 250px;"></div>
</div>

<p>
    <textarea id="messages" rows="5" cols="120">
    </textarea>
</p>

<div id="customAlert" style="overflow-y:scroll;">
    <p id="customAlertText"></p>
    <button onclick="closeCustomAlert();userFocus(currentUserId);">OK, update the user page now</button>
</div>

<script src="scripts.js"></script>
<script>
    var cy = cytoscape({

      container: document.getElementById('cy'), // container to render in

      elements: [],

      style: [ // the stylesheet for the graph
        {
          selector: 'node',
          style: {
            'background-color': '#666',
            'label': 'data(id)',
            width: 'data(weight)',
            height: 'data(weight)'
          }
        },

        {
          selector: 'edge',
          style: {
            'width': 3,
            'line-color': '#ccc',
            'target-arrow-color': '#ccc',
            'target-arrow-shape': 'triangle',
            'curve-style': 'bezier'
          }
        }
      ]

    });

    cy.on('tap', 'node', function(evt){
      var node = evt.target;
      alert(node.id());
      userFocus(node.id());
    });
</script>
</body>
</html>